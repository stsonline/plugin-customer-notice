function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

(function () {
  this.customerNotice = function () {

    // default plugin options
    var defaults = {
      api: {
        url: 'https://example.com/api/status',
        vendor: {
          url: 'https://example.com/api/forms/example'
        }
      },
      timeout: 70000,
      element: 'ptframe',
      theme: {
        color: '#924a8b'
      },
      tracking: {
        id: 'UA-XXXXXXXX-X',
        name: 'customerPlugin',
        title: 'Customer Plugin'
      }
    };


    // create options
    if (arguments[0] && _typeof(arguments[0]) === "object") {
      this.options = extendDefaults(defaults, arguments[0]);
    };


    // init variables with options
    var endpoint = this.options.api.url,
        endpointVendor = this.options.api.vendor.url,
        fetchTimeout = this.options.timeout,
        elPrepend = this.options.element,
        themeColor = this.options.theme.color,
        trackingID = this.options.tracking.id,
        trackingName = this.options.tracking.name,
        trackingTitle = this.options.tracking.title


    // define hardcoded variables which can't be changed
    var tryToImportGa = 0,
        isGaAvailable = false


    // check if site Google Analytics is already loaded
    function isGaImportable() {
      if (typeof ga === 'function' || tryToImportGa++ > 3) {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', trackingID, {'name':'customerNoticePlugin'});
        isGaAvailable = true;
      } else {
        setTimeout(isGaImportable, 500);
      }
    }


    // send reporting data
    function trackGaItem(title) {
      if (isGaAvailable) {
        ga(`${trackingName}.send`, "event", trackingTitle, title, "")
      }
    }


    // prototypes
    Element.prototype.appendBefore = function (element) {
      element.parentNode.insertBefore(this, element);
    },false;


    // hide the application
    function hideApplication(type) {
      if (document.getElementById(elPrepend)) {
        document.getElementById(elPrepend).style.display = 'none';
        document.getElementById(elPrepend).style.visibility = 'hidden';
        document.getElementById(elPrepend).style.opacity = '0';

        // show third party application
        showThirdPartyApplication(type)

        // show the notice
        showNoticeToCustomer(type)
      }
    }


    // show third-party application
    function showThirdPartyApplication(cause) {
      var notice = document.createElement("div");
          notice.innerHTML = `<div id="customer-notice--plugin" style=
                              "text-align:center;font-family:sans-serif;font-weight:400;font-size:16px!important;max-width:375px;margin:16px auto;line-height:1.7;">
                                <div style=
                                "padding:20px;margin:0 16px;border: 1px solid #f5f4f4;border-top:3px solid ${themeColor};background-color:#fbfbfb;">
                                  <iframe id="vendor-form" src='${endpointVendor}' width="100%" frameborder="0" scrolling="yes" style="min-height:1570px;overflow-y:auto;"></iframe>
                                </div>
                              </div>`;

      // inject the notice
      if (document.getElementById(elPrepend)) {
        var prependBefore = document.getElementById(elPrepend)
        notice.appendBefore(prependBefore);
          trackGaItem(`Customer notice triggered [showing third-party form] - reason: ${(cause != '') ? cause : 'not set'}`)
      }
    }


    // show a notice to the customer
    function showNoticeToCustomer(cause) {
      var noticeIcons = ['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="64" width="64"> <path d="M500.989 348.464v13.29c0 20.623-16.714 37.337-37.326 37.337H48.337c-20.612 0-37.326-16.714-37.326-37.337v-13.29h489.978z" fill="#5a6b96"/> <path d="M500.989 51.152v297.312H11.011V51.152c0-20.623 16.714-37.337 37.326-37.337h415.326c20.612 0 37.326 16.714 37.326 37.337z" fill="#efefef"/> <path d="M333.075 498.184H178.924c12.022-32.827 17.426-66.269 17.734-99.097h118.683c.309 32.829 5.713 66.27 17.734 99.097z" fill="#264087"/> <path d="M382.624 206.789v-49.548H349.11c-2.221-8.337-5.531-16.233-9.773-23.526l23.719-23.719-35.037-35.036L304.3 98.679c-7.291-4.242-15.188-7.553-23.526-9.773V55.391h-49.548v33.515c-8.337 2.22-16.233 5.531-23.526 9.773L183.981 74.96l-35.036 35.036 23.719 23.719c-4.242 7.291-7.553 15.188-9.773 23.526h-33.515v49.548h33.515c2.221 8.337 5.531 16.233 9.773 23.526l-23.719 23.719 35.036 35.036 23.719-23.719c7.291 4.242 15.188 7.553 23.526 9.773v33.514h49.548v-33.515c8.337-2.22 16.233-5.531 23.526-9.773l23.719 23.719 35.036-35.036-23.719-23.719c4.242-7.291 7.553-15.188 9.773-23.526h33.515zM256 234.315c-28.885 0-52.301-23.415-52.301-52.301s23.417-52.301 52.301-52.301c28.886 0 52.301 23.415 52.301 52.301S284.885 234.315 256 234.315z" fill="#45ccff"/> <g fill="#231f20"> <path d="M463.663 2.804H48.337C21.683 2.804 0 24.493 0 51.152v310.602c0 26.659 21.683 48.348 48.337 48.348h136.991c-1.233 26.664-6.005 52.51-14.227 77.072h-33.467c-6.08 0-11.011 4.93-11.011 11.011 0 6.081 4.931 11.011 11.011 11.011h236.731c6.08 0 11.011-4.93 11.011-11.011 0-6.081-4.931-11.011-11.011-11.011h-33.468c-8.222-24.562-12.993-50.408-14.227-77.072h136.992c26.654 0 48.337-21.689 48.337-48.348V51.152C512 24.493 490.317 2.804 463.663 2.804zM22.022 51.152c0-14.517 11.806-26.327 26.316-26.327h415.326c14.511 0 26.316 11.81 26.316 26.327v286.302H22.022V51.152zm295.735 436.022H194.243c7.592-24.704 11.996-50.528 13.14-77.072h97.233c1.145 26.544 5.549 52.369 13.141 77.072zm172.222-125.42c0 14.517-11.806 26.327-26.316 26.327H48.337c-14.511 0-26.316-11.81-26.316-26.327v-2.279h467.957v2.279z"/> <path d="M382.624 146.23h-25.408c-1.263-3.564-2.715-7.06-4.35-10.472l17.975-17.975c4.3-4.3 4.3-11.272 0-15.571l-35.035-35.036c-4.3-4.3-11.269-4.3-15.573 0L302.257 85.15a106.9822 106.9822 0 00-10.472-4.35V55.391c0-6.081-4.931-11.011-11.011-11.011h-49.548c-6.08 0-11.011 4.93-11.011 11.011V80.8a106.958 106.958 0 00-10.473 4.35l-17.974-17.975c-4.3-4.3-11.27-4.3-15.573 0l-35.036 35.036c-2.065 2.065-3.225 4.866-3.225 7.786s1.161 5.721 3.225 7.786l17.975 17.975a106.9822 106.9822 0 00-4.35 10.472h-25.407c-6.08 0-11.011 4.93-11.011 11.011v49.548c0 6.081 4.931 11.011 11.011 11.011h25.407c1.263 3.564 2.716 7.06 4.35 10.472l-17.975 17.975a11.0115 11.0115 0 00-3.225 7.786c0 2.92 1.161 5.721 3.225 7.786l35.036 35.036c2.066 2.065 4.866 3.225 7.786 3.225s5.721-1.161 7.786-3.225l17.974-17.975a106.856 106.856 0 0010.473 4.35v25.408c0 6.081 4.931 11.011 11.011 11.011h49.548c6.08 0 11.011-4.93 11.011-11.011V283.23c3.563-1.263 7.06-2.715 10.472-4.35l17.975 17.975a11.0132 11.0132 0 007.786 3.225c2.92 0 5.72-1.161 7.786-3.225l35.035-35.036c4.3-4.3 4.3-11.272 0-15.571l-17.975-17.975c1.635-3.412 3.087-6.908 4.35-10.472h25.411c6.08 0 11.011-4.93 11.011-11.011v-49.548c-.001-6.083-4.931-11.012-11.011-11.012zm-11.011 49.548h-22.504c-4.989 0-9.356 3.355-10.64 8.178-1.94 7.284-4.85 14.29-8.65 20.822-2.513 4.32-1.802 9.789 1.731 13.323l15.934 15.934-19.465 19.465-15.934-15.934c-3.534-3.534-9.005-4.244-13.324-1.731-6.532 3.801-13.537 6.711-20.82 8.65-4.822 1.284-8.178 5.651-8.178 10.64v22.504h-27.527v-22.504c0-4.99-3.356-9.356-8.178-10.64-7.284-1.939-14.29-4.85-20.822-8.651-4.316-2.513-9.789-1.802-13.323 1.732L183.981 273.5l-19.465-19.465 15.934-15.934c3.533-3.533 4.244-9.003 1.731-13.324-3.801-6.53-6.712-13.536-8.651-20.821-1.284-4.822-5.651-8.178-10.64-8.178h-22.503v-27.527h22.504c4.989 0 9.356-3.355 10.64-8.178a84.7542 84.7542 0 018.651-20.821c2.513-4.32 1.802-9.79-1.731-13.324l-15.934-15.934 19.465-19.464 15.933 15.933c3.533 3.533 9.006 4.244 13.323 1.732 6.534-3.801 13.539-6.711 20.822-8.651 4.822-1.284 8.178-5.651 8.178-10.64V66.402h27.527v22.504c0 4.989 3.355 9.356 8.177 10.64 7.286 1.94 14.291 4.851 20.821 8.651 4.32 2.512 9.79 1.804 13.324-1.731l15.934-15.933 19.465 19.464-15.934 15.934c-3.533 3.533-4.244 9.003-1.731 13.323 3.8 6.533 6.711 13.538 8.65 20.822 1.284 4.822 5.651 8.178 10.64 8.178h22.503v27.524z"/> <path d="M255.999 118.703c-34.911 0-63.312 28.401-63.312 63.312s28.401 63.312 63.312 63.312 63.312-28.401 63.312-63.312-28.401-63.312-63.312-63.312zm0 104.602c-22.768 0-41.29-18.523-41.29-41.29s18.522-41.29 41.29-41.29 41.29 18.523 41.29 41.29-18.522 41.29-41.29 41.29zM456.58 189.546c-6.08 0-11.011 4.93-11.011 11.011v101.666c0 6.081 4.931 11.011 11.011 11.011s11.011-4.93 11.011-11.011V200.557c-.001-6.081-4.931-11.011-11.011-11.011zM456.58 146.391c-6.08 0-11.011 4.93-11.011 11.011v1.101c0 6.081 4.931 11.011 11.011 11.011s11.011-4.93 11.011-11.011v-1.101c-.001-6.081-4.931-11.011-11.011-11.011z"/> </g> </svg>', '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="64" width="64"> <path d="M298.894 10.894H30.366c-10.078 0-18.247 8.169-18.247 18.247V482.86c0 10.078 8.169 18.247 18.247 18.247h268.528c10.078 0 18.247-8.169 18.247-18.247V29.14c-.001-10.077-8.17-18.246-18.247-18.246z" fill="#5a6b96"/> <path fill="#efefef" d="M12.119 54.468H317.14v359.489H12.119z"/> <path d="M474.281 10.894H274.928c-14.139 0-25.6 11.461-25.6 25.6v123.098c0 14.139 11.461 25.6 25.6 25.6h42.303v55.92l55.921-55.92h101.129c14.139 0 25.6-11.461 25.6-25.6V36.494c0-14.139-11.461-25.6-25.6-25.6z" fill="#fbc640"/> <g fill="#231f20"> <path d="M186.96 446.637h-44.664c-6.015 0-10.894 4.878-10.894 10.894 0 6.015 4.878 10.894 10.894 10.894h44.664c6.015 0 10.894-4.878 10.894-10.894-.001-6.016-4.878-10.894-10.894-10.894z"/> <path d="M474.281 0H30.366C14.298 0 1.226 13.072 1.226 29.14v453.72c0 16.068 13.072 29.14 29.14 29.14h268.528c16.068 0 29.14-13.072 29.14-29.14V245.716l49.63-49.631h96.617c20.123 0 36.494-16.371 36.494-36.494V36.494C510.774 16.371 494.404 0 474.281 0zM306.247 403.064H23.013V65.362h215.421v94.23c0 20.123 16.371 36.494 36.494 36.494h31.319v206.978zM30.366 21.787H241.54c-1.991 4.502-3.106 9.475-3.106 14.706v7.081H23.013V29.14c0-4.054 3.298-7.353 7.353-7.353zm268.528 468.426H30.366c-4.055 0-7.353-3.299-7.353-7.353v-58.009h283.234v58.009c0 4.054-3.299 7.353-7.353 7.353zm190.093-330.622c0 8.109-6.597 14.706-14.706 14.706h-101.13a10.896 10.896 0 00-7.703 3.191l-37.324 37.325v-29.622c0-6.015-4.878-10.894-10.894-10.894h-42.303c-8.109 0-14.706-6.597-14.706-14.706V36.494c0-8.109 6.597-14.706 14.706-14.706H474.28c8.109 0 14.706 6.597 14.706 14.706v123.097z"/> <path d="M374.604 38.49c-6.015 0-10.894 4.878-10.894 10.894v51.927c0 6.015 4.878 10.894 10.894 10.894 6.015 0 10.894-4.878 10.894-10.894V49.384c0-6.015-4.878-10.894-10.894-10.894zM374.604 133.991c-6.015 0-10.894 4.878-10.894 10.894v1.089c0 6.015 4.878 10.894 10.894 10.894 6.015 0 10.894-4.878 10.894-10.894v-1.089c0-6.015-4.878-10.894-10.894-10.894z"/></g></svg>', '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.002 512.002" width="64" height="64"> <g fill="#fbc640"> <path d="M288.722 66.066c0 28.481-62.167 51.567-138.835 51.567-76.685 0-138.835-23.086-138.835-51.567s62.151-51.567 138.835-51.567c76.669 0 138.835 23.086 138.835 51.567z"/> <path d="M288.722 66.066v325.54c0 28.481-62.167 51.567-138.835 51.567-76.685 0-138.835-23.086-138.835-51.567V66.066c0 28.481 62.151 51.567 138.835 51.567 76.669.001 138.835-23.086 138.835-51.567z"/> </g> <path d="M500.949 384.156v-55.142H463.65c-2.471-9.279-6.155-18.066-10.877-26.181l26.396-26.396-38.992-38.991-26.396 26.396c-8.115-4.722-16.902-8.405-26.181-10.877v-37.299h-55.142v37.298c-9.279 2.471-18.066 6.155-26.181 10.877l-26.396-26.396-38.991 38.991 26.396 26.397c-4.722 8.115-8.405 16.902-10.877 26.181h-37.298v55.142h37.298c2.471 9.278 6.156 18.066 10.877 26.181l-26.396 26.396 38.991 38.991 26.396-26.396c8.115 4.722 16.902 8.405 26.181 10.877v37.299H387.6v-37.299c9.279-2.471 18.066-6.155 26.181-10.877l26.396 26.396 38.992-38.991-26.396-26.396c4.722-8.115 8.405-16.902 10.877-26.181h37.299zm-140.92 30.634c-32.146 0-58.205-26.059-58.205-58.205s26.059-58.205 58.205-58.205 58.205 26.059 58.205 58.205c.001 32.147-26.059 58.205-58.205 58.205z" fill="#efefef"/> <g fill="#231f20"> <path d="M192.742 209.561c.532 0 1.071-.039 1.613-.117l1.677-.249c6.036-.911 10.19-6.543 9.279-12.579-.911-6.036-6.546-10.187-12.579-9.279l-1.573.232c-6.04.883-10.22 6.494-9.337 12.535.8 5.499 5.523 9.457 10.92 9.457zM360.029 287.328c-38.189 0-69.258 31.068-69.258 69.258s31.068 69.258 69.258 69.258 69.258-31.068 69.258-69.258-31.068-69.258-69.258-69.258zm0 116.41c-26 0-47.153-21.153-47.153-47.153s21.153-47.153 47.153-47.153 47.153 21.152 47.153 47.153c0 26.001-21.153 47.153-47.153 47.153z"/> <path d="M500.948 317.962H471.82c-1.548-4.472-3.367-8.846-5.443-13.102l20.608-20.608a11.054 11.054 0 003.237-7.815c0-2.931-1.165-5.743-3.237-7.815l-38.991-38.991c-4.317-4.316-11.313-4.316-15.631 0l-20.608 20.608a117.685 117.685 0 00-13.102-5.442v-29.13c0-6.104-4.949-11.052-11.052-11.052h-55.143c-6.103 0-11.052 4.948-11.052 11.052v29.129a117.6061 117.6061 0 00-13.102 5.442l-8.531-8.531V66.066c0-13.25-8.306-32.129-47.871-46.825C224.477 9.056 188.246 3.447 149.884 3.447c-38.368 0-74.599 5.609-102.023 15.795C8.305 33.936 0 52.816 0 66.066v325.54c0 13.251 8.305 32.13 47.865 46.825 27.422 10.186 63.654 15.795 102.023 15.795 30.067 0 58.792-3.465 83.021-9.861.057.061.107.125.167.185l38.991 38.991c4.317 4.316 11.313 4.316 15.631 0l20.608-20.608c4.255 2.077 8.631 3.894 13.102 5.442v29.129c0 6.104 4.949 11.052 11.052 11.052h55.143c6.103 0 11.052-4.948 11.052-11.052v-29.129c4.471-1.548 8.846-3.365 13.102-5.442l20.608 20.608c4.317 4.316 11.313 4.316 15.631 0l38.991-38.991a11.054 11.054 0 003.237-7.815c0-2.931-1.165-5.743-3.237-7.815l-20.608-20.608c2.077-4.255 3.894-8.631 5.443-13.102h29.128c6.103 0 11.052-4.948 11.052-11.052v-55.142c-.002-6.106-4.95-11.054-11.054-11.054zm-281.837 0c-6.103 0-11.052 4.948-11.052 11.052v22.558c-16.888 3.046-36.432 4.912-58.172 4.912-78.004 0-127.781-23.996-127.781-40.515V266.79c6.593 4.411 15.016 8.712 25.76 12.703 27.422 10.185 63.654 15.795 102.023 15.795 30.505 0 59.638-3.561 84.088-10.136l19.709 19.71a117.5017 117.5017 0 00-5.443 13.102h-29.13v-.002zm-69.225-128.08c-78.002 0-127.781-23.996-127.781-40.515V100.2c6.591 4.408 15.025 8.704 25.76 12.691 27.422 10.186 63.654 15.795 102.023 15.795 38.363 0 74.593-5.609 102.017-15.795 10.739-3.989 19.174-8.285 25.766-12.694v49.17c0 8.686-14.765 21.546-47.751 30.694-5.881 1.631-9.327 7.722-7.697 13.604 1.358 4.894 5.801 8.101 10.645 8.101.978 0 1.972-.13 2.961-.405 17.327-4.806 31.368-10.856 41.842-17.892v43.15c-2.052.418-4.011 1.418-5.604 3.01l-29.741 29.741c-22.165 7.937-53.843 13.812-92.438 13.812-78.006 0-127.784-23.996-127.784-40.515v-49.179c6.593 4.411 15.016 8.712 25.76 12.703 27.422 10.186 63.654 15.795 102.023 15.795 6.103 0 11.052-4.948 11.052-11.052s-4.948-11.052-11.053-11.052zm0-164.33c78.004 0 127.783 23.995 127.783 40.515s-49.779 40.515-127.783 40.515c-78.002 0-127.781-23.996-127.781-40.515s49.778-40.515 127.781-40.515zM22.105 391.607v-41.515c6.593 4.411 15.016 8.711 25.76 12.703 27.422 10.186 63.654 15.795 102.023 15.795 20.333 0 40.034-1.606 58.172-4.606v10.173c0 6.104 4.949 11.052 11.052 11.052h29.129c1.547 4.47 3.365 8.846 5.443 13.102l-9.212 9.211c-22.242 8.332-54.724 14.599-94.584 14.599-78.004 0-127.783-23.996-127.783-40.514zm467.79-18.503H463.65c-5.008 0-9.39 3.368-10.68 8.208-2.187 8.214-5.468 16.109-9.75 23.468-2.522 4.336-1.809 9.827 1.737 13.375l18.582 18.581-23.36 23.36-18.581-18.581c-3.548-3.547-9.04-4.26-13.373-1.737-7.362 4.283-15.258 7.563-23.469 9.75-4.84 1.29-8.208 5.671-8.208 10.68v26.246H343.51v-26.246c0-5.009-3.368-9.391-8.209-10.68-8.211-2.187-16.106-5.468-23.465-9.749-4.335-2.523-9.826-1.81-13.375 1.737l-18.582 18.581-23.36-23.36 18.581-18.581c3.547-3.547 4.26-9.038 1.737-13.373-4.284-7.363-7.564-15.259-9.749-23.468-1.289-4.84-5.671-8.209-10.68-8.209h-26.246v-33.037h26.246c5.009 0 9.391-3.369 10.68-8.209 2.186-8.209 5.465-16.103 9.749-23.466 2.522-4.336 1.809-9.827-1.737-13.373l-18.581-18.582 23.36-23.36 18.582 18.581c3.547 3.547 9.04 4.26 13.375 1.737a95.5965 95.5965 0 0123.465-9.749c4.841-1.29 8.209-5.671 8.209-10.68V226.72h33.038v26.245c0 5.009 3.368 9.391 8.208 10.68 8.212 2.187 16.107 5.468 23.469 9.75 4.333 2.521 9.825 1.81 13.373-1.739l18.581-18.581 23.36 23.36-18.582 18.581c-3.547 3.547-4.26 9.039-1.737 13.375 4.283 7.359 7.563 15.255 9.75 23.468 1.29 4.839 5.672 8.208 10.68 8.208h26.245v33.037z"/> </g> </svg>', '<svg viewBox="0 -14 512.00001 512" height="64" width="64" xmlns="http://www.w3.org/2000/svg"><path d="m126.605469 210.292969 60 103.921875c-27.238281 15.726562-58.890625 34-86.601563 50-28.699218 16.570312-65.390625 6.742187-81.960937-21.960938-16.46875-28.503906-6.917969-65.292968 21.960937-81.960937zm0 0" fill="#2bbdc4"/><path d="m409.457031 243.816406c7.589844 13.136719-1.660156 29.617188-16.832031 29.988282l-11.25 2.210937-.25-1.269531-128.730469-222.972656-.839843-.660157 7.199218-9.171875c7.910156-12.957031 26.800782-12.738281 34.390625.410156 199.792969 346.03125-52.261719-90.527343 116.3125 201.464844zm0 0" fill="#2bbdc4"/><path d="m206.964844 429.488281c8.289062 14.339844 3.371094 32.6875-10.980469 40.976563-14.328125 8.289062-32.710937 3.355468-40.980469-10.976563l-55-95.273437 51.960938-30c.476562.828125 54.917968 95.128906 55 95.273437zm0 0" fill="#495d85"/><path d="m377.777344 108.933594 20 34.640625-24.640625 37.320312-40-69.28125zm0 0" fill="#e9eef0"/><path d="m381.125 274.746094.25 1.269531-194.769531 38.199219-60-103.921875 124.949219-159.179688.839843.660157zm0 0" fill="#adf3ff"/><path d="m136.964844 308.234375c4.78125-2.757813 6.417968-8.878906 3.660156-13.660156-2.761719-4.777344-8.878906-6.417969-13.660156-3.660157-4.78125 2.761719-6.421875 8.882813-3.660156 13.660157 2.757812 4.78125 8.878906 6.421875 13.660156 3.660156zm0 0"/><path d="m95.984375 377.253906 50.359375 87.230469c10.867188 18.84375 35.3125 25.820313 54.644531 14.644531 19.128907-11.054687 25.703125-35.496094 14.636719-54.640625l-30-51.96875 25.980469-15c4.78125-2.765625 6.421875-8.878906 3.660156-13.660156l-13.003906-22.523437c1.550781-.300782 11.746093-2.300782 191.539062-37.570313 22.226563-1.207031 35.542969-25.515625 24.316407-44.949219l-33.234376-57.5625 21.238282-32.167968c2.085937-3.164063 2.210937-7.230469.316406-10.511719l-20-34.640625c-1.894531-3.28125-5.492188-5.203125-9.261719-4.980469l-38.472656 2.308594-36.894531-63.90625c-5.34375-9.257813-14.917969-14.863281-25.605469-14.996094-.128906-.003906-.253906-.003906-.382813-.003906-10.328124 0-19.703124 5.140625-25.257812 13.832031l-130.632812 166.414062-84.925782 49.03125c-33.402344 19.277344-44.972656 62.128907-25.621094 95.621094 17.679688 30.625 54.953126 42.671875 86.601563 30zm102.324219 57.238282c5.523437 9.554687 2.253906 21.78125-7.328125 27.316406-9.613281 5.558594-21.855469 2.144531-27.316407-7.320313l-50-86.613281 34.640626-20c57.867187 100.242188 49.074218 85.011719 50.003906 86.617188zm-22.683594-79.296876-10-17.320312 17.320312-10 10 17.320312zm196.582031-235.910156 13.820313 23.9375-12.324219 18.664063-23.820313-41.261719zm-104.917969-72.132812c2.683594-4.390625 6.941407-4.84375 8.667969-4.796875 1.707031.019531 5.960938.550781 8.527344 4.996093l116.3125 201.464844c3.789063 6.558594-.816406 14.804688-8.414063 14.992188-1.363281.03125-1.992187.277344-5.484374.929687l-123.035157-213.105469c2.582031-3.320312 2.914063-3.640624 3.425781-4.480468zm-16.734374 21.433594 115.597656 200.222656-174.460938 34.21875-53.046875-91.878906zm-223.851563 268.667968c-4.390625-7.597656-6.710937-16.222656-6.710937-24.949218 0-17.835938 9.585937-34.445313 25.011718-43.351563l77.941406-45 50 86.601563-77.941406 45.003906c-23.878906 13.78125-54.515625 5.570312-68.300781-18.304688zm0 0"/><path d="m105.984375 314.574219c-2.761719-4.78125-8.878906-6.421875-13.660156-3.660157l-17.320313 10c-4.773437 2.757813-10.902344 1.113282-13.660156-3.660156-2.761719-4.78125-8.878906-6.421875-13.660156-3.660156s-6.421875 8.878906-3.660156 13.660156c8.230468 14.257813 26.589843 19.285156 40.980468 10.980469l17.320313-10c4.78125-2.761719 6.421875-8.875 3.660156-13.660156zm0 0"/><path d="m497.136719 43.746094-55.722657 31.007812c-4.824218 2.6875-6.5625 8.777344-3.875 13.601563 2.679688 4.820312 8.765626 6.566406 13.601563 3.875l55.71875-31.007813c4.828125-2.6875 6.5625-8.777344 3.875-13.601562-2.683594-4.828125-8.773437-6.5625-13.597656-3.875zm0 0"/><path d="m491.292969 147.316406-38.636719-10.351562c-5.335938-1.429688-10.820312 1.734375-12.25 7.070312-1.429688 5.335938 1.738281 10.816406 7.074219 12.246094l38.640625 10.351562c5.367187 1.441407 10.824218-1.773437 12.246094-7.070312 1.429687-5.335938-1.738282-10.820312-7.074219-12.246094zm0 0"/><path d="m394.199219 7.414062-10.363281 38.640626c-1.429688 5.335937 1.734374 10.816406 7.070312 12.25 5.332031 1.425781 10.816406-1.730469 12.25-7.070313l10.359375-38.640625c1.429687-5.335938-1.734375-10.820312-7.070313-12.25-5.332031-1.429688-10.816406 1.734375-12.246093 7.070312zm0 0"/></svg>']
      var notice = document.createElement("div");
          notice.innerHTML = `<div id="customer-notice--plugin" style=
                              "text-align:center;font-family:sans-serif;font-weight:400;font-size:16px!important;max-width:375px;margin:16px auto;line-height:1.7;">
                                <div style=
                                "padding:20px;margin:0 16px;border: 1px solid #f5f4f4;border-top:3px solid ${themeColor};background-color:#fbfbfb;">
                                  <div>
                                    <div>
                                      ${noticeIcons[Math.floor(Math.random() * noticeIcons.length)]}
                                      <h3 style=
                                      "font-weight:600;font-size:16px!important;font-family:inherit;margin:0;padding:0;color:${themeColor}">
                                      Undergoing Maintenance</h3>
                                      <h6 style=
                                      "margin:0;margin-top: 3px;font-size:14px!important;font-weight:300;line-height:1.4;font-family:inherit;padding:0;margin-bottom:0;color:#777">
                                      Scheduled maintenance in progress, we'll be back up shortly.</h6>
                                    </div>
                                  </div>
                                </div>
                              </div>`;

      // inject the notice
      if (document.getElementById(elPrepend)) {
        var prependBefore = document.getElementById(elPrepend)
        notice.appendBefore(prependBefore);

        trackGaItem(`Customer notice triggered - reason: ${(cause != '') ? cause : 'not set'}`)
      }
    }


    // check system health
    function systemHealth(url) {
      var xhr = new XMLHttpRequest()
      xhr.addEventListener('error', noticeErr)

      xhr.open('GET', url, true)
      xhr.timeout = fetchTimeout
      xhr.ontimeout = function () {
        noticeErr('network')
      }

      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.response != null) {
          initNotice(JSON.parse(xhr.response))
        }
      }

      function initNotice(res) {
        if (res && res.online && res.customer_notice === true) {
          hideApplication('manual')
        }
      }

      function noticeErr(type) {
        hideApplication((type) ? type : 'down')
      }


      // plugin is loaded
      trackGaItem("Plugin loaded")
      xhr.send()
    }


    // decide whether to attempt system health check
    if (window.XMLHttpRequest) {
      isGaImportable()

      // check health
      systemHealth(endpointVendor)
    }


    // extend defaults
    function extendDefaults(source, properties) {
      var property;

      for (property in properties) {
        if (properties.hasOwnProperty(property)) {
          source[property] = properties[property];
        }
      }

      return source;
    }

  }
})();
